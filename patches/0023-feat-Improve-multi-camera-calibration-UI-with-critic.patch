From 4d6cc74aaf019401c75f4f3d4571f3cd12fcf28e Mon Sep 17 00:00:00 2001
From: SusumuTakano <genspark_dev@genspark.ai>
Date: Sat, 20 Dec 2025 14:21:18 +0000
Subject: [PATCH 23/26] feat: Improve multi-camera calibration UI with critical
 instructions
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Problem:
- Stride discrepancy between multi-camera (1.39m) and single-camera (1.57m)
- Root cause: User clicking cones that don't cover full 5m segment
- Example: Segment 1 only covered 0.37m-4.22m (3.85m) instead of 0-5m

Solution (Calibration Re-do Approach):
- Add prominent warning banner with critical calibration instructions
- Emphasize: 'Click cones CLOSEST to segment start/end positions'
- Explain consequences: 'If cones are at 0.5m/4.5m instead of 0m/5m, stride will be inaccurate'
- Highlight per-segment instructions in CalibrationPanel

UI Improvements:
- Yellow gradient warning banner with âš ï¸ icon
- Bullet-pointed instructions for clarity
- Per-segment hint: '{startDistanceM}måœ°ç‚¹ã¨{endDistanceM}måœ°ç‚¹ã«æœ€ã‚‚è¿‘ã„ã‚³ãƒ¼ãƒ³ã‚’é¸æŠ'
- Example provided: 'For 0-5m segment, select cones near 0m and 5m positions'

Expected Result:
- User will recalibrate with cones closer to actual 0m, 5m, 10m, 15m markers
- This should make multi-camera stride match single-camera (1.57m, 1.61m)
- Homography accuracy + proper cone placement = correct stride values
---
 src/components/MultiCameraSetup.tsx | 49 ++++++++++++++++++++++++-----
 1 file changed, 41 insertions(+), 8 deletions(-)

diff --git a/src/components/MultiCameraSetup.tsx b/src/components/MultiCameraSetup.tsx
index 98ef129..206d742 100644
--- a/src/components/MultiCameraSetup.tsx
+++ b/src/components/MultiCameraSetup.tsx
@@ -184,16 +184,26 @@ const CalibrationPanel: React.FC<{
     <div className="border rounded-lg p-4 bg-gray-50">
       <div className="flex items-start justify-between gap-4">
         <div>
-          <div className="font-medium">
+          <div className="font-medium" style={{ fontSize: '1.1rem' }}>
             ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³: {segment.startDistanceM}m ã¨ {segment.endDistanceM}mï¼ˆæ‰‹å‰/å¥¥ï¼‰
           </div>
-          <div className="text-sm text-gray-600 mt-1">
-            ã‚¯ãƒªãƒƒã‚¯é †: <span className="font-medium">{nextLabel}</span>
-            {points.length < 4 && <span> ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼ˆ{points.length}/4ï¼‰</span>}
-            {points.length === 4 && <span>ï¼ˆ4ç‚¹æƒã„ã¾ã—ãŸã€‚ä¿å­˜ã§ãã¾ã™ï¼‰</span>}
+          <div className="text-sm mt-2" style={{ 
+            background: '#eff6ff', 
+            padding: '8px 12px', 
+            borderRadius: '6px',
+            border: '1px solid #bfdbfe'
+          }}>
+            <div style={{ fontWeight: 600, color: '#1e40af', marginBottom: '4px' }}>
+              ã‚¯ãƒªãƒƒã‚¯é †: <span style={{ color: '#dc2626' }}>{nextLabel}</span>
+              {points.length < 4 && <span> ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼ˆ{points.length}/4ï¼‰</span>}
+              {points.length === 4 && <span style={{ color: '#16a34a' }}>ï¼ˆâœ“ 4ç‚¹æƒã„ã¾ã—ãŸï¼‰</span>}
+            </div>
+            <div style={{ fontSize: '0.85rem', color: '#475569' }}>
+              âš ï¸ <strong>{segment.startDistanceM}måœ°ç‚¹ã¨{segment.endDistanceM}måœ°ç‚¹ã«æœ€ã‚‚è¿‘ã„ã‚³ãƒ¼ãƒ³</strong>ã‚’é¸æŠã—ã¦ãã ã•ã„
+            </div>
           </div>
-          <div className="text-xs text-gray-500 mt-1">
-            â€» å¿…ãšã€Œã‚³ãƒ¼ãƒ³ã®ä¸­å¿ƒã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã€‚4ç‚¹ã™ã¹ã¦åŒã˜ãƒ•ãƒ¬ãƒ¼ãƒ ã§å®Ÿæ–½ã—ã¦ãã ã•ã„ã€‚
+          <div className="text-xs text-gray-500 mt-2">
+            â€» ã‚³ãƒ¼ãƒ³ã®ä¸­å¿ƒã‚’æ­£ç¢ºã«ã‚¯ãƒªãƒƒã‚¯ã€‚4ç‚¹ã™ã¹ã¦åŒã˜ãƒ•ãƒ¬ãƒ¼ãƒ ã§å®Ÿæ–½ã€‚
           </div>
         </div>
 
@@ -664,9 +674,32 @@ export const MultiCameraSetup: React.FC<MultiCameraSetupProps> = ({
         {step === 'calibrate' && (
           <div className="p-6">
             <h2 className="text-2xl font-bold mb-2">ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆã‚³ãƒ¼ãƒ³4ç‚¹ã‚¯ãƒªãƒƒã‚¯ï¼‰</h2>
-            <div className="text-sm text-gray-600 mb-6">
+            <div className="text-sm text-gray-600 mb-4">
               å„å‹•ç”»ã§ã€{config.segmentLengthM}mé–“éš”ã®2æœ¬ã®ã‚³ãƒ¼ãƒ³ï¼ˆæ‰‹å‰/å¥¥ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€å¹³é¢å¤‰æ›ã‚’ä½œæˆã—ã¾ã™ã€‚
             </div>
+            
+            {/* é‡è¦ãªæ³¨æ„äº‹é … */}
+            <div style={{
+              background: 'linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)',
+              border: '2px solid #f59e0b',
+              borderRadius: '12px',
+              padding: '16px',
+              marginBottom: '24px'
+            }}>
+              <div style={{ fontWeight: 'bold', marginBottom: '8px', color: '#92400e', fontSize: '1.1rem' }}>
+                âš ï¸ é‡è¦ï¼šæ­£ç¢ºãªã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ãŸã‚ã«
+              </div>
+              <ul style={{ margin: 0, paddingLeft: '20px', color: '#78350f', lineHeight: '1.8' }}>
+                <li><strong>åŒºé–“ã®é–‹å§‹ä½ç½®ã¨çµ‚äº†ä½ç½®ã«æœ€ã‚‚è¿‘ã„ã‚³ãƒ¼ãƒ³</strong>ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„</li>
+                <li>ä¾‹ï¼š0-5måŒºé–“ãªã‚‰ã€<strong>0mä»˜è¿‘ã¨5mä»˜è¿‘ã®ã‚³ãƒ¼ãƒ³</strong>ã‚’é¸æŠ</li>
+                <li>ã‚³ãƒ¼ãƒ³ã®ä½ç½®ãŒ0.5mã‚„4.5mãªã©ã€å¢ƒç•Œã‹ã‚‰é›¢ã‚Œã™ãã‚‹ã¨<strong>ã‚¹ãƒˆãƒ©ã‚¤ãƒ‰ãŒä¸æ­£ç¢º</strong>ã«ãªã‚Šã¾ã™</li>
+                <li>å„ã‚³ãƒ¼ãƒ³ã®<strong>ä¸­å¿ƒ</strong>ã‚’æ­£ç¢ºã«ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„</li>
+                <li><strong>4ç‚¹ã™ã¹ã¦åŒã˜ãƒ•ãƒ¬ãƒ¼ãƒ </strong>ã§å®Ÿæ–½ã—ã¦ãã ã•ã„</li>
+              </ul>
+              <div style={{ marginTop: '12px', padding: '8px 12px', background: '#fffbeb', borderRadius: '6px', color: '#92400e' }}>
+                ğŸ’¡ <strong>ãƒ’ãƒ³ãƒˆ</strong>: ã‚«ãƒ¡ãƒ©ã®è¦–é‡å†…ã§ã€0måœ°ç‚¹ã¨5måœ°ç‚¹ã«æœ€ã‚‚è¿‘ã„ã‚³ãƒ¼ãƒ³ãŒè¦‹ãˆã‚‹ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚
+              </div>
+            </div>
 
             <div className="space-y-4">
               {segments.map((segment, idx) => {
-- 
2.39.5

