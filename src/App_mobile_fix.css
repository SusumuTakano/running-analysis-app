/* モバイル専用の修正CSS - App.cssの後に読み込む */

/* ============================================
   iPhoneでのレイアウト崩れ修正
   ============================================ */

/* モバイル全般の修正 */
@media (max-width: 768px) {
  /* ヘッダーの修正 */
  .app-header-new {
    position: sticky !important;
    top: 0 !important;
    z-index: 1001 !important;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
    padding: 12px 8px !important;
    margin: 0 0 16px 0 !important;
    width: 100% !important;
    overflow: visible !important;
  }

  /* タイトルとサブタイトルの調整 */
  .app-title-new {
    font-size: 1.3rem !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    margin-bottom: 4px !important;
  }

  .app-subtitle-new {
    font-size: 0.75rem !important;
    line-height: 1.2 !important;
    white-space: normal !important;
    word-break: keep-all !important;
  }

  /* ヘッダー内のボタン配置 */
  .app-header-new button {
    font-size: 0.75rem !important;
    padding: 6px 10px !important;
    white-space: nowrap !important;
  }

  /* ユーザー名の非表示（スペース節約） */
  .app-header-new span:last-child {
    display: none !important;
  }
}

/* マーカー配置フィールドの修正 */
@media (max-width: 768px) {
  /* マーカーテーブル全体 */
  .marker-table {
    width: 100% !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }

  /* テーブルセル間隔の調整 */
  .marker-table th,
  .marker-table td {
    padding: 8px 4px !important;
    font-size: 0.8rem !important;
  }

  /* 入力フィールドの幅調整 */
  .marker-table input[type="number"] {
    width: 60px !important;
    padding: 4px !important;
    font-size: 0.85rem !important;
  }

  /* フレーム選択ボタン */
  .marker-table button {
    padding: 4px 8px !important;
    font-size: 0.75rem !important;
    white-space: nowrap !important;
  }

  /* マーカー種別の表示 */
  .marker-table .marker-type {
    font-size: 0.75rem !important;
    white-space: nowrap !important;
  }
}

/* フレームスライダーの修正 */
@media (max-width: 768px) {
  /* スライダーコンテナ */
  .frame-slider-container {
    padding: 10px 5px !important;
    margin: 10px 0 !important;
  }

  /* スライダー本体 */
  .frame-slider {
    width: calc(100% - 10px) !important;
    margin: 0 5px !important;
  }

  /* コントロールボタン配置 */
  .frame-controls {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 5px !important;
    justify-content: center !important;
    padding: 10px 5px !important;
  }

  .frame-controls button {
    flex: 0 0 auto !important;
    min-width: 50px !important;
    padding: 8px 10px !important;
    font-size: 0.8rem !important;
  }

  /* 再生速度セレクト */
  .playback-speed-select {
    width: auto !important;
    font-size: 0.8rem !important;
  }
}

/* ステップインジケーターの修正 */
@media (max-width: 768px) {
  .step-progress {
    display: flex !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
    padding: 10px 5px !important;
    gap: 8px !important;
  }

  .step-item {
    flex: 0 0 auto !important;
    min-width: 60px !important;
  }

  .step-circle {
    width: 32px !important;
    height: 32px !important;
    font-size: 0.85rem !important;
  }

  .step-name {
    font-size: 0.65rem !important;
    white-space: nowrap !important;
  }
}

/* メインコンテンツエリアの調整 */
@media (max-width: 768px) {
  .wizard-main {
    padding: 10px !important;
    margin-top: 10px !important;
  }

  .wizard-content {
    padding: 15px !important;
    margin: 10px 0 !important;
  }

  .wizard-step-title {
    font-size: 1.2rem !important;
    margin-bottom: 8px !important;
  }

  .wizard-step-desc {
    font-size: 0.85rem !important;
    line-height: 1.4 !important;
  }
}

/* ボタンとフォーム要素の調整 */
@media (max-width: 768px) {
  /* プライマリボタン */
  .btn-primary,
  .btn-primary-large {
    font-size: 0.9rem !important;
    padding: 10px 16px !important;
    width: 100% !important;
    margin: 5px 0 !important;
  }

  /* セカンダリボタン */
  .btn-secondary,
  .btn-outline {
    font-size: 0.85rem !important;
    padding: 8px 14px !important;
  }

  /* 入力フィールド */
  .input-field,
  .textarea-field,
  select {
    font-size: 16px !important; /* iOS zoom防止 */
    padding: 10px !important;
  }

  /* ラベル */
  .input-label {
    font-size: 0.9rem !important;
  }
}

/* モーダルとポップアップの調整 */
@media (max-width: 768px) {
  .modal-content {
    width: calc(100% - 20px) !important;
    max-height: calc(100vh - 40px) !important;
    margin: 20px 10px !important;
    padding: 15px !important;
  }

  .modal-header {
    font-size: 1.1rem !important;
    padding-bottom: 10px !important;
  }

  .modal-body {
    font-size: 0.9rem !important;
  }
}

/* チャートとグラフの調整 */
@media (max-width: 768px) {
  .chart-container {
    width: 100% !important;
    height: 250px !important;
    margin: 10px 0 !important;
  }

  canvas {
    max-width: 100% !important;
    height: auto !important;
  }
}

/* テーブルのレスポンシブ対応 */
@media (max-width: 768px) {
  table {
    font-size: 0.8rem !important;
  }

  th, td {
    padding: 6px 4px !important;
  }

  /* 横スクロール可能にする */
  .table-wrapper {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }
}

/* iOS特有の修正 */
@supports (-webkit-touch-callout: none) {
  /* iOS Safariでのタップハイライト無効化 */
  * {
    -webkit-tap-highlight-color: transparent;
  }

  /* iOS入力フィールドのズーム防止 */
  input[type="text"],
  input[type="number"],
  input[type="email"],
  input[type="password"],
  textarea,
  select {
    font-size: 16px !important;
  }

  /* iOSでの慣性スクロール有効化 */
  .scrollable {
    -webkit-overflow-scrolling: touch;
  }
}

/* 特定の問題箇所の修正 */

/* Step 5のマーカー配置画面 */
@media (max-width: 768px) {
  /* マーカーテーブルの横スクロール対応 */
  .marker-placement-section {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }

  /* マーカーテーブル本体 */
  .marker-placement-section table {
    min-width: 500px !important; /* 最小幅を設定 */
  }

  /* ヘッダー固定解除（モバイル時） */
  .marker-placement-section thead {
    position: relative !important;
  }

  /* セル内の要素配置 */
  .marker-placement-section td {
    vertical-align: middle !important;
  }

  /* 入力フィールドとボタンの間隔 */
  .marker-placement-section input {
    margin-right: 5px !important;
  }

  .marker-placement-section button {
    margin-left: 5px !important;
  }
}

/* フレームナビゲーション */
@media (max-width: 768px) {
  .frame-navigation {
    position: fixed !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    background: white !important;
    border-top: 1px solid #e5e7eb !important;
    padding: 10px !important;
    z-index: 1000 !important;
  }

  /* メインコンテンツの下部余白 */
  .wizard-main {
    padding-bottom: 80px !important; /* ナビゲーション分の余白 */
  }
}

/* パフォーマンス最適化 */
@media (max-width: 768px) {
  /* 不要なアニメーションを無効化 */
  * {
    animation-duration: 0.1s !important;
    transition-duration: 0.1s !important;
  }

  /* 影の簡略化 */
  .shadow,
  .shadow-md,
  .shadow-lg {
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
  }
}